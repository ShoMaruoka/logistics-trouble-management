# 物流トラブル管理システム 開発計画

## プロジェクト概要
- **プロジェクト名**: 物流トラブル管理システム
- **技術スタック**: Next.js 15.4.6 (フロントエンド) + ASP.NET Core 8.0 LTS (バックエンド) + SQL Server 2022
- **開発環境**: Windows 11 + Docker (開発用DB)
- **開始日**: 2025-08-12

## 開発フェーズ

### 🔴 フェーズ1: 環境構築と基盤整備 (優先度: 高)
- [x] 1.1 機能仕様書の作成
  - [x] 既存フロントエンドコードの分析
  - [x] データモデルの定義
  - [x] API仕様の設計
  - [x] 画面仕様の整理
  - [x] 見積時間: 4時間

- [x] 1.2 プロジェクト構造の整理
  - [x] 既存のNext.jsプロジェクトをfrontend/配下に移動
  - [x] backend/ディレクトリの作成
  - [x] database/ディレクトリの作成
  - [x] deployment/ディレクトリの作成
  - [x] docs/ディレクトリの作成
  - [x] 全体ディレクトリ構造の整備
  - [x] 見積時間: 2時間

- [x] 1.3 開発用データベース環境の構築
  - [x] Docker Composeファイルの作成 (SQL Server 2022)
  - [x] データベース初期化スクリプトの作成
  - [x] サンプルデータの作成
  - [x] 接続設定の確認
  - [x] 見積時間: 3時間

- [x] 1.4 バックエンドプロジェクトの作成
  - [x] ASP.NET Core 8.0 LTS ソリューションの作成
  - [x] 各レイヤープロジェクトの作成 (API, Core, Infrastructure, Domain, Tests)
  - [x] 基本的なNuGetパッケージの追加
  - [x] 基本的な設定ファイルの作成
  - [x] 見積時間: 4時間

### 🟡 フェーズ2: ドメインモデルとデータベース設計 (優先度: 高)
- [x] 2.1 ドメインモデルの実装
  - [x] BaseEntityクラスの作成
  - [x] Incidentエンティティの実装
  - [x] Userエンティティの実装（簡易版）
  - [x] Attachmentエンティティの実装
  - [x] AuditLogエンティティの実装（簡易版）
  - [x] 列挙型の定義 (IncidentStatus, Priority, UserRole等)
  - [x] 値オブジェクトの実装 (Email, PhoneNumber等)
  - [x] 見積時間: 6時間

- [x] 2.2 Entity Framework Core設定
  - [x] ApplicationDbContextの実装
  - [x] エンティティ設定クラスの作成
  - [x] 初期マイグレーションの作成（ベースライン）
  - [x] データベース接続のテスト（マイグレーション適用）
  - [x] サンプルデータの投入
  - [x] 見積時間: 4時間

- [x] 2.3 リポジトリパターンの実装
  - [x] IRepository<T>インターフェースの作成
  - [x] 各エンティティのリポジトリ実装
  - [x] Unit of Workパターンの実装
  - [x] DIコンテナへの登録
  - [x] 見積時間: 5時間

### 🟡 フェーズ3: バックエンドAPI開発 (優先度: 高)
- [ ] 3.1 トラブル管理API（モック版）
  - [ ] IncidentsControllerの実装
  - [ ] CRUD操作の実装（GET, POST, PUT, DELETE）
  - [ ] 検索・フィルタリング機能
  - [ ] ページネーション機能
  - [ ] ソート機能
  - [ ] 見積時間: 8時間

- [ ] 3.2 統計API（モック版）
  - [ ] StatisticsControllerの実装
  - [ ] ダッシュボード統計API
  - [ ] グラフデータAPI
  - [ ] PPM計算API
  - [ ] 見積時間: 4時間

- [ ] 3.3 ファイル管理API（モック版）
  - [ ] AttachmentsControllerの実装
  - [ ] ファイルアップロード機能
  - [ ] ファイルダウンロード機能
  - [ ] ファイル一覧取得機能
  - [ ] 見積時間: 4時間

- [ ] 3.4 効果測定API（モック版）
  - [ ] EffectivenessControllerの実装
  - [ ] 効果測定登録機能
  - [ ] 効果測定一覧取得機能
  - [ ] 見積時間: 3時間

- [ ] 3.5 バリデーションとエラーハンドリング
  - [ ] FluentValidationの実装
  - [ ] グローバルエラーハンドリング
  - [ ] カスタム例外クラスの実装
  - [ ] 見積時間: 4時間

### 🟢 フェーズ3.5: 認証・認可システム (優先度: 低)
- [ ] 3.6 認証・認可システム
  - [ ] JWT認証の実装
  - [ ] AuthControllerの作成
  - [ ] ユーザー登録・ログイン機能
  - [ ] 権限管理機能
  - [ ] 見積時間: 8時間

- [ ] 3.7 ユーザー管理API
  - [ ] UsersControllerの実装
  - [ ] ユーザー情報管理機能
  - [ ] 権限管理機能
  - [ ] 見積時間: 6時間

### 🟢 フェーズ4: フロントエンド開発 (優先度: 中)
- [ ] 4.1 APIクライアントの実装
  - [ ] API呼び出し用のサービス作成
  - [ ] エラーハンドリング
  - [ ] レスポンス型定義
  - [ ] 見積時間: 4時間

- [ ] 4.2 トラブル管理画面の実装
  - [ ] トラブル一覧画面（既存の改良）
  - [ ] トラブル詳細画面
  - [ ] トラブル作成・編集画面（既存の改良）
  - [ ] 検索・フィルタリング機能（既存の改良）
  - [ ] ページネーション機能
  - [ ] 見積時間: 8時間

- [ ] 4.3 ダッシュボードの実装
  - [ ] 統計情報の表示（既存の改良）
  - [ ] グラフ・チャートの実装（既存の改良）
  - [ ] フィルタ機能（既存の改良）
  - [ ] 見積時間: 4時間

- [ ] 4.4 ファイル管理機能の実装
  - [ ] ファイルアップロード機能
  - [ ] ファイル表示機能
  - [ ] ファイルダウンロード機能
  - [ ] 見積時間: 4時間

- [ ] 4.5 効果測定機能の実装
  - [ ] 効果測定登録画面
  - [ ] 効果測定一覧画面
  - [ ] 効果測定詳細画面
  - [ ] 見積時間: 3時間

### 🟢 フェーズ4.5: 認証機能 (優先度: 低)
- [ ] 4.6 認証画面の実装
  - [ ] ログイン画面
  - [ ] ユーザー登録画面
  - [ ] パスワードリセット画面
  - [ ] 見積時間: 8時間

### 🟢 フェーズ5: テストと品質保証 (優先度: 中)
- [ ] 5.1 単体テスト
  - [ ] サービス層のテスト
  - [ ] リポジトリ層のテスト
  - [ ] バリデーションのテスト
  - [ ] 見積時間: 6時間

- [ ] 5.2 統合テスト
  - [ ] APIコントローラーのテスト
  - [ ] データベース統合テスト
  - [ ] 見積時間: 4時間

- [ ] 5.3 E2Eテスト
  - [ ] トラブル管理フローのテスト
  - [ ] ダッシュボード表示のテスト
  - [ ] ファイルアップロードのテスト
  - [ ] 見積時間: 4時間

- [ ] 5.4 パフォーマンステスト
  - [ ] API応答時間の測定
  - [ ] データベースクエリの最適化
  - [ ] 見積時間: 2時間

### ⚪ フェーズ6: デプロイメントと運用準備 (優先度: 低)
- [ ] 6.1 開発環境の最適化
  - [ ] Docker環境の最適化
  - [ ] 開発用データベースの最適化
  - [ ] ログ設定の改善
  - [ ] 見積時間: 3時間

- [ ] 6.2 監視・ログ設定
  - [ ] Serilog設定
  - [ ] ヘルスチェック実装
  - [ ] 基本的な監視設定
  - [ ] 見積時間: 2時間

- [ ] 6.3 ドキュメント整備
  - [ ] APIドキュメントの作成（Swagger）
  - [ ] 開発者向けマニュアルの作成
  - [ ] 見積時間: 3時間

### ⚪ フェーズ7: 本番環境準備 (優先度: 低)
- [ ] 7.1 本番環境設定
  - [ ] IIS設定の準備
  - [ ] 本番データベース設定
  - [ ] 環境変数の設定
  - [ ] 見積時間: 4時間

- [ ] 7.2 本番監視設定
  - [ ] Application Insights設定
  - [ ] 本番ログ設定
  - [ ] アラート設定
  - [ ] 見積時間: 3時間

- [ ] 7.3 運用ドキュメント整備
  - [ ] ユーザーマニュアルの作成
  - [ ] 運用マニュアルの作成
  - [ ] 障害対応マニュアルの作成
  - [ ] 見積時間: 6時間

## 技術的制約と注意事項

### 技術スタック制約
- **ASP.NET Core**: 8.0 LTS (バージョン変更禁止)
- **Next.js**: 15.4.6 (バージョン変更禁止)
- **React**: 19.1.0 (バージョン変更禁止)
- **SQL Server**: 2022 (開発用はDocker可)

### 開発環境制約
- **OS**: Windows 11
- **IDE**: Visual Studio 2022 / Visual Studio Code
- **データベース**: Docker上でSQL Server 2022

### アーキテクチャ制約
- **Clean Architecture**: 4層構成の厳守
- **Repository Pattern**: データアクセス層での使用
- **Unit of Work Pattern**: トランザクション管理
- **Dependency Injection**: 疎結合設計

### モック開発の優先事項
- **認証機能**: 後回し（フェーズ3.5以降）
- **既存フロントエンド**: 最大限活用
- **サンプルデータ**: 豊富に準備
- **基本機能**: 完全実装優先

## リスク管理

### 技術的リスク
- [ ] SQL Server Docker環境での接続問題
- [ ] ASP.NET Core 8.0 LTSの互換性問題
- [ ] Next.js 15.4.6の新機能による問題
- [ ] 既存フロントエンドとの統合問題

### 対応策
- [ ] 早期にDocker環境での動作確認
- [ ] 段階的な機能実装とテスト
- [ ] 既存のNext.jsプロジェクトとの統合テスト
- [ ] モックデータでの動作確認優先

## 進捗管理

### 週次レビュー項目
- [ ] 完了タスクの確認
- [ ] 未完了タスクの再評価
- [ ] 新規リスクの特定
- [ ] 次週の優先タスク決定

### マイルストーン
- **Week 1**: 環境構築完了（フェーズ1）
- **Week 2**: ドメインモデル実装完了（フェーズ2）
- **Week 3**: バックエンドAPI基本機能完了（フェーズ3）
- **Week 4**: フロントエンド基本機能完了（フェーズ4）
- **Week 5**: テスト完了（フェーズ5）
- **Week 6**: 開発環境最適化完了（フェーズ6）
- **Week 7**: 本番環境準備完了（フェーズ7）

## 品質基準

### コード品質
- [ ] SonarQube分析での品質ゲート通過
- [ ] コードカバレッジ80%以上
- [ ] 静的解析エラー0件

### パフォーマンス
- [ ] API応答時間500ms以内
- [ ] ページ読み込み時間2秒以内
- [ ] データベースクエリ100ms以内

### セキュリティ
- [ ] OWASP Top 10対策
- [ ] SQL Injection対策
- [ ] XSS対策
- [ ] CSRF対策

---

**最終更新**: 2025-08-12
**作成者**: 開発チーム
